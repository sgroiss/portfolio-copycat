---
const {
  id = "not-set",
  title = "Project not-set",
  desc = "not set",
  img = null,
  imgAlt = title,
  overlayColor = null,
} = Astro.props;

// wie in Marquee.astro: viele Wiederholungen, damit genug Breite da ist
const EM_SPACE = "\u2002";
const repeated = Array.from({ length: 10 })
  .map(() => title)
  .join(EM_SPACE);
---

<article
  itemscope
  itemtype="https://schema.org/CreativeWork"
  class="project-card group"
>
  {
    img && (
      <div class="relative mb-4 rounded-xs overflow-hidden">
        <img src={img} alt={imgAlt} itemprop="image" class="block w-full" />

        {overlayColor && (
          <div class="project-overlay absolute inset-0 flex items-center overflow-hidden">
            {/* Hintergrund-Layer mit 0 â†’ 90% Opacity */}
            <div
              class="project-overlay-bg absolute inset-0 opacity-0 group-hover:opacity-90 transition-opacity duration-400"
              style={`background-color: ${overlayColor}`}
              aria-hidden="true"
            />

            {/* Text-Layer mit eigener Opacity-Animation */}
            <div class="project-marquee relative w-full overflow-hidden whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-400">
              <div
                class="project-marquee__inner inline-flex w-max text-6xl leading-none"
                aria-hidden="true"
              >
                <span class="py-2 font-white">{repeated}</span>
                <span class="py-2 font-white">{repeated}</span>
              </div>
            </div>
          </div>
        )}
      </div>
    )
  }

  <h1 id={`project-${id}`} itemprop="headline" class="text-lg uppercase">
    {title}
  </h1>

  <p
    id={`project-${id}-desc`}
    itemprop="description"
    class="text-sm -mt-1 text-sg-secondary"
  >
    {desc}
  </p>
</article>

<style>
  .project-marquee__inner {
    animation: project-marquee 40s linear infinite;
  }

  @keyframes project-marquee {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-50%);
    }
  }
</style>
